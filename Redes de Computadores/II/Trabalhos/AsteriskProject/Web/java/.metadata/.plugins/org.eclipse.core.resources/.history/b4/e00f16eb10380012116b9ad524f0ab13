package redes2;

import java.util.ArrayList;
import java.util.List;

import util.imp.IaxImp;
import util.interfaces.Iax;

public class IAXRamalFacade {
	private static List<IAXRamal> ramais = new ArrayList<IAXRamal>();
	private static Iax iax = new IaxImp();
	private static boolean fake = false;

	public static List<IAXRamal> getIaxRamais() {
		if (fake) {
			if (ramais.isEmpty()) {
				for (int i = 0; i < 3; i++) {
					ramais.add(new IAXRamal("IAX-460" + i, "Ramal <3000>",
							"friend", "3000", "lab$3000", "LOCAL", "dynamic",
							"md5", "yes", "no"));
				}
			}
			return ramais;
		} else {
			List<IAXRamal> toReturn = new ArrayList<IAXRamal>();
			for (int i = 0; i < iax.getNumberOfSessions(); i++) {
				String sessionName = iax.getSessionName(i);
				//sessionName, 
				String callerid = iax.getVariableValue(						sessionName, "callerid"); 
				String type = iax.getVariableValue(
						sessionName, "type");
				String username= iax.getVariableValue(sessionName,					"username");
				String secret = iax						.getVariableValue(sessionName, "secret");
				String canreinvite = iax
						.getVariableValue(sessionName, "canreinvite");
				String host = iax
						.getVariableValue(sessionName, "host");
				String context =iax
						.getVariableValue(sessionName, "context"); String dtmfmode= iax
						.getVariableValue(sessionName, "dtmfmode");String call_limit= iax
						.getVariableValue(sessionName, "call-limit");String nat= iax
						.getVariableValue(sessionName, "nat"));
				toReturn.add(new IAXRamal());
			}
			return toReturn;
		}
	}

	public static void addIaxRamal(IAXRamal iaxRamal) {
		getIaxRamais().add(iaxRamal);
	}

	public static void deleteIaxRamal(String iaxRamalId) {
		IAXRamal toRemove = null;
		for (IAXRamal iaxRamal : getIaxRamais()) {
			if (iaxRamal.isSame(iaxRamalId)) {
				toRemove = iaxRamal;
			}
		}
		if (toRemove != null) {
			getIaxRamais().remove(toRemove);
		}
	}

	public static void updateIaxRamal(IAXRamal iaxRamal) {
		updateIaxRamal(iaxRamal.getId(), iaxRamal);
	}

	public static void updateIaxRamal(String iaxRamalId, IAXRamal iaxRamal) {
		deleteIaxRamal(iaxRamalId);
		addIaxRamal(iaxRamal);
	}

	public static IAXRamal getIaxRamal(String iaxRamalId) {
		for (IAXRamal iaxRamal : getIaxRamais()) {
			if (iaxRamal.isSame(iaxRamalId)) {
				return iaxRamal;
			}
		}
		return null;
	}
}